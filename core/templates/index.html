{% extends 'partials/base.html' %}
{% block content %}
<main class="pb-10">
    <!-- STATUS DOS USUÁRIOS  -->
    <section class="w-11/12 grid grid-cols-1 md:grid-cols-3 gap-6 mt-10 mx-auto">
        <div class="flex items-center space-x-4 border border-gray-300 rounded-xl p-4 bg-white hover:bg-gray-100 transition duration-200">
            <div class="bg-indigo-500 size-12 rounded-2xl flex items-center justify-center text-white shadow">
                <i class="fa-solid fa-user-group text-2xl"></i>
            </div>
            <div>
                <h3 class="font-bold text-2xl">{{usuarios|length}}</h3>
                <p class="text-gray-500 text-xs">Total de Usuários</p>
            </div>
        </div>

        <div class="flex items-center space-x-4 border border-gray-300 rounded-xl p-4 bg-white hover:bg-gray-100 transition duration-200">
            <div class="bg-green-500 size-12 rounded-2xl flex items-center justify-center text-white shadow">
                <i class="fa-solid fa-user-check text-2xl"></i>
            </div>
            <div>
                <h3 class="font-bold text-2xl">{{usuarios_ativos}}</h3>
                <p class="text-gray-500 text-xs">Usuários Ativos</p>
            </div>
        </div>

        <div class="flex items-center space-x-4 border border-gray-300 rounded-xl p-4 bg-white hover:bg-gray-100 transition duration-200">
            <div class="bg-gray-500 size-12 rounded-2xl flex items-center justify-center text-white shadow">
                <i class="fa-solid fa-user-xmark text-2xl"></i>
            </div>
            <div>
                <h3 class="font-bold text-2xl">{{usuarios_inativos}}</h3>
                <p class="text-gray-500 text-xs">Usuários Inativos</p>
            </div>
        </div>
    </section>

    <!-- PESQUISA E ADICIONAR USUÁRIO -->
    <nav class="my-8 w-11/12 md:flex mx-auto justify-between px-2 space-y-2 md:space-y-0">
        <input type="text" class="bg-white border border-gray-300 rounded-lg p-2 text-gray-800 focus:outline-gray-400" placeholder="Busca por nome...">

        <button @click="modalCadastrar = true" class="flex space-x-2 items-center p-2 bg-indigo-600 text-white shadow hover:shadow-lg hover:scale-105 transition duration-300 rounded-xl cursor-pointer">
            <i class="fa-solid fa-plus"></i>
            <p>Novo Usuário</p>
        </button>
    </nav>

    <!-- LISTAGEM DE USUÁRIOS DESKTOP  -->
    <section class="hidden md:block">
        <table class="bg-white table-auto w-11/12 mx-auto border-collapse border border-gray-300 shadow">
            <thead class="">
                <tr class="divide-x divide-gray-300">
                    <th class="p-4 text-left text-gray-500 font-normal">Nome</th>
                    <th class="p-4 text-left text-gray-500 font-normal">Cargo</th>
                    <th class="p-4 text-left text-gray-500 font-normal">Status</th>
                    <th class="p-4 text-left text-gray-500 font-normal">Ações</th>
                </tr>
            </thead>

            <tbody>
                {% for usuario in usuarios %}
                <tr class="group hover:bg-gray-100 transition duration-200">
                    <td class="border border-gray-300">
                        <div class="p-4 flex items-center">
                                <p class="size-10 bg-indigo-500 rounded-full flex items-center justify-center text-white shadow">{{usuario.nome|first}}</p>
                        <p class="ml-3 text-gray-500">{{usuario.nome}}</p>
                        </div>
                        
                    </td>

                    <td  class="border border-gray-300">
                        <div class="p-4 flex items-center">
                            <p class="ml-3 text-gray-500">{{usuario.cargo}}</p>
                        </div>
                    </td>

                    <td  class="border border-gray-300">
                        {% if usuario.status == True %}
                        <div class="p-4 flex items-center">
                            <div class="bg-green-100 rounded-full border border-green-700 flex items-center justify-center py-1 px-3">
                                <div class="size-3 bg-green-500 rounded-full"></div>
                                <p class="ml-2 text-green-600">Ativo</p>
                            </div>
                        </div>
                        {% elif usuario.status == False %}
                        <div class="p-4 flex items-center">
                            <div class="bg-gray-100 rounded-full border border-gray-700 flex items-center justify-center py-1 px-3">
                                <div class="size-3 bg-gray-500 rounded-full"></div>
                                <p class="ml-2 text-gray-600">Inativo</p>
                            </div>
                        </div>
                        {% endif %}
                    </td>

                    <td  class="border border-gray-300">
                        <div class="p-4 flex items-center">
                            <div class="flex  items-center justify-center text-gray-500">
                                <div x-data="{modalEditar: false, modalExcluir: false}" class="group-hover:opacity-100 opacity-0 flex w-full space-x-3 transition duration-300">
                                    <button @click="modalEditar = true" class="hover:bg-indigo-200 hover:text-indigo-600 rounded-full size-8 flex items-center justify-center transition duration-200 cursor-pointer">
                                        <i class="fa-solid fa-pen"></i>
                                    </button>

                                    <button @click="modalExcluir = true" class="hover:bg-red-200 hover:text-red-600 rounded-full size-8 flex items-center justify-center transition duration-200 cursor-pointer">
                                        <i class="fa-solid fa-trash"></i>
                                    </button>

                                    {% include 'modals/remove_user.html' %}
                                    {% include 'modals/edit_user.html' %}
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>


    <!-- LISTAGEM DE USUÁRIOS MOBILE  -->
    <section class="md:hidden">
        <div class="bg-white rounded-t-xl w-11/12 mx-auto shadow">
            {% for usuario in usuarios %}
            <div x-data="{modalExcluir: false, modalEditar: false}" class="p-4 flex items-center justify-between border border-gray-300">
                <div class="flex items-center">
                    <p class="size-10 bg-indigo-500 rounded-full flex items-center justify-center text-white shadow">{{ usuario.nome|first }}</p>
                    <div class="ml-3 text-gray-500">
                        <p>{{usuario.nome}}</p>
                        <p class="text-gray-400 text-sm">{{usuario.cargo}}</p>
                    </div>
                </div>

                <div>
                    {% if usuario.status == True %}
                    <div class="bg-green-100 rounded-full border border-green-700 flex items-center justify-center py-1 px-3">
                        <div class="size-3 bg-green-500 rounded-full"></div>
                        <p class="ml-2 text-green-600">Ativo</p>
                    </div>
                    {% else %}
                     <div class="bg-gray-100 rounded-full border border-gray-700 flex items-center justify-center py-1 px-3">
                        <div class="size-3 bg-gray-500 rounded-full"></div>
                        <p class="ml-2 text-gray-600">Inativo</p>
                    </div>
                    {% endif %}
                    <div class="text-gray-500 mt-2 flex w-full space-x-3">
                        <button @click="modalEditar = true" class="size-8 flex items-center justify-center">
                            <i class="fa-solid fa-pen"></i>
                        </button>

                        <button @click="modalExcluir = true" class="size-8 flex items-center justify-center">
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </div>
                </div>
                {% include 'modals/remove_user.html' %}
                {% include 'modals/edit_user.html' %}
            </div>

           
            {% endfor %}
        </div>
    </section>

    {% if status == 'erro'%}
        <!-- erro -->
        <div class="absolute fixed inset-0 bg-black/70 pt-40">
            <div class="bg-white rounded-xl shadow-lg w-11/12 max-w-120 mx-auto">
                <div class="p-6 space-y-4">
                    <div class="">
                        <div class="bg-red-200 rounded-full p-2 size-20 flex items-center justify-center mx-auto">
                            <i class="fa-solid fa-triangle-exclamation text-red-700 text-3xl"></i>
                        </div>

                        <p class="text-center font-semibold text-xl">Erro ao adicionar usuário</p>
                    </div>

                    <div class="flex items-center space-x-5">
                        <a href="{% url 'index' %}" class="text-center w-full bg-red-600 text-white p-2 rounded-lg shadow hover:bg-red-700 transition duration-200 cursor-pointer">Fechar</a>
                    </div>
                </div>
            </div>
        </div>
    {% elif status == 'sucesso' %}
        <!-- Sucesso -->
        <div class="absolute fixed inset-0 bg-black/70 pt-40">
            <div class="bg-white rounded-xl shadow-lg w-11/12 max-w-120 mx-auto">
                <div class="p-6 space-y-4">
                    <div class="">
                        <div class="bg-green-200 rounded-full p-2 size-20 flex items-center justify-center mx-auto">
                            <i class="fa-solid fa-triangle-exclamation text-green-700 text-3xl"></i>
                        </div>

                        <p class="text-center font-semibold text-xl">Usuário Adicionado com sucesso!</p>
                    </div>

                    <div class="flex items-center space-x-5">
                        <a href="{% url 'index' %}" class="text-center w-full bg-green-600 text-white p-2 rounded-lg shadow hover:bg-green-700 transition duration-200 cursor-pointer">Fechar</a>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}

    {% include 'modals/add_user.html' %}
</main>
{% endblock content %}